# Hydrogen Platform - 계산 로직 정의 필요 항목

## 현재 상태 요약

현재 시뮬레이션은 **백엔드에서 실제 계산을 수행**하고 있으나, 일부 데이터가 더미/시뮬레이션 데이터로 대체되어 있습니다.

---

## 1. 핵심 계산 로직 (현재 구현됨)

### 1.1 수소 생산량 계산 (energy_8760.py)

```
수소 생산량 (kg/h) = 투입 전력 (kW) × 효율 (%) / 비소비량 (kWh/kg)
```

**현재 구현된 변수:**
- `electrolyzer_capacity_mw`: 전해조 용량 (MW)
- `efficiency`: 전해조 효율 (%)
- `specific_consumption`: 수소 1kg 생산에 필요한 전력 (kWh/kg)
- `annual_availability`: 연간 가동률 (%)

**질문 필요:**
- [ ] 비소비량 기본값이 `(100 / efficiency) × 33.33` 맞는지?
- [ ] 33.33 kWh/kg은 수소의 저위발열량(LHV) 기준인지?

---

### 1.2 효율 저하 계산

```
실효 효율 = 초기 효율 × (1 - 열화율)^(연차-1)
```

**현재 기본값:**
- PEM 열화율: 0.5%/년
- ALK 열화율: 0.3%/년

**질문 필요:**
- [ ] 열화율 값이 적절한지?
- [ ] 스택 수명 후 효율 회복 로직이 필요한지?

---

### 1.3 재무 분석 (financial.py)

#### NPV (순현재가치)
```
NPV = -초기투자 + Σ(연간순현금흐름_t / (1 + 할인율)^t)
```

#### IRR (내부수익률)
```
NPV = 0 이 되는 할인율 (Newton-Raphson 방법)
```

#### LCOH (수소 균등화 비용)
```
LCOH = (CAPEX + Σ OPEX의 현재가치) / (Σ 수소 생산량의 현재가치)
```

#### DSCR (부채원리금상환비율)
```
DSCR = (매출 - 운영비) / 부채상환액
```

**질문 필요:**
- [ ] 법인세, 감가상각 반영 로직이 필요한지?
- [ ] 대출 조건 (이자율, 거치기간, 상환기간) 입력이 필요한지?

---

## 2. 더미 데이터로 대체된 항목 (실제 데이터 필요)

### 2.1 전력 가격 데이터

**현재 방식:**
```python
# 시간대별 배수로 수학적 생성
피크 (09-12, 17-21): 기준가 × 1.5
경부하 (23-06): 기준가 × 0.7
중간부하 (기타): 기준가 × 1.0
```

**필요한 실제 데이터:**
- [ ] 한국전력 SMP (계통한계가격) 실제 시간대별 데이터
- [ ] PPA 계약 조건별 가격 구조
- [ ] 재생에너지 인증서(REC) 가격 반영 여부

---

### 2.2 기상 데이터 (재생에너지 연계 시)

**현재 방식:**
```python
# 삼각함수 기반 수학적 시뮬레이션
태양 복사량 = sin(시간) × sin(일자) 패턴
풍속 = 기본값 + 계절변동 + 일변동
```

**필요한 실제 데이터:**
- [ ] TMY3 (Typical Meteorological Year) 데이터
- [ ] 지역별 일사량/풍속 데이터
- [ ] 재생에너지 발전량 예측 모델

---

### 2.3 수소 판매 가격

**현재 기본값:** 6,000원/kg

**질문 필요:**
- [ ] 수소 가격 시나리오 (수소경제 로드맵 기준?)
- [ ] 장기 계약 vs 현물 시장 가격 구조
- [ ] 부생수소, 그레이수소, 블루수소, 그린수소 가격 차이

---

## 3. 프론트엔드에서 확인이 필요한 계산

### 3.1 CAPEX 자동 계산 (PresetSelector.tsx)

```typescript
capex = 전해조용량(MW) × 1000 × 단위CAPEX(원/kW)
```

**현재 기본값:**
| 유형 | 단위 CAPEX |
|------|-----------|
| PEM 소규모 | 1,500,000 원/kW |
| PEM 중규모 | 1,200,000 원/kW |
| ALK 대규모 | 800,000 원/kW |

**질문 필요:**
- [ ] 단위 CAPEX 값이 현재 시장 기준으로 적절한지?
- [ ] BOP (Balance of Plant) 비용 포함 여부?

---

### 3.2 OPEX 비율 계산

```typescript
연간 OPEX = CAPEX × OPEX비율(%)
```

**현재 기본값:** 2.5%

**질문 필요:**
- [ ] OPEX에 포함되는 항목 정의 필요 (유지보수, 인건비, 보험 등)

---

### 3.3 스택 교체 비용

```typescript
스택교체비용 = CAPEX × 30%
```

**질문 필요:**
- [ ] 스택 교체 시점 계산 로직 (운전시간 기준? 연차 기준?)
- [ ] 스택 수명: PEM 80,000시간, ALK 90,000시간이 적절한지?

---

## 4. 몬테카를로 시뮬레이션 파라미터

### 현재 설정

| 파라미터 | 기본값 | 설명 |
|---------|-------|------|
| iterations | 10,000 | 시뮬레이션 반복 횟수 |
| weather_sigma | 0.1 | 기상 변동성 (표준편차) |
| price_sigma | 0.15 | 가격 변동성 (표준편차) |

**질문 필요:**
- [ ] 각 sigma 값이 현실적인지?
- [ ] 상관관계 고려 필요 여부 (예: 태양광↔전력가격)

---

## 5. 민감도 분석 범위

### 현재 설정

| 변수 | Low | High |
|------|-----|------|
| 전력가격 | -20% | +20% |
| 수소가격 | -10% | +10% |
| 가동률 | -5% | +5% |
| 효율 | -3% | +3% |
| CAPEX | -15% | +15% |

**질문 필요:**
- [ ] 각 변동 범위가 현실적인지?
- [ ] 추가로 분석할 변수가 있는지?

---

## 6. 입력 필요한 정보 체크리스트

사용자께서 아래 항목들에 대해 확인/제공해 주시면 더 정확한 시뮬레이션이 가능합니다:

### 필수
- [ ] 수소 가격 시나리오 (원/kg)
- [ ] 전력 가격 구조 (PPA 가격, SMP 등)
- [ ] 전해조 사양 (용량, 효율, 열화율)
- [ ] CAPEX/OPEX 기준

### 권장
- [ ] 프로젝트 수명 (기본 20년)
- [ ] 할인율 (기본 8%)
- [ ] 대출 조건 (부채비율, 이자율)
- [ ] 세금 조건 (법인세율, 감가상각)

### 선택
- [ ] 실제 기상 데이터 (TMY)
- [ ] 실제 전력가격 데이터 (SMP)
- [ ] 보조금/인센티브 조건

---

## 7. 다음 단계

1. **위 체크리스트 확인** - 사용자께서 필요한 수식/값 제공
2. **계산 로직 검증** - 제공된 정보로 백엔드 로직 수정
3. **프론트엔드 연동 확인** - 입력값 변경 시 실시간 반영 테스트
4. **결과 검증** - 예상 결과와 비교 테스트

---

*이 문서는 시뮬레이션 로직 검토를 위해 생성되었습니다.*
*필요한 수식이나 값을 알려주시면 해당 부분을 구현/수정하겠습니다.*
